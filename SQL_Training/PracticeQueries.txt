SQL> -- WAQTD NAME OF THE EMPLOYEES WHO ARE HAVING ATLEAST 3 REPORTINGS
SQL> SELECT M.ENAME
  2  FROM EMP E,EMP M
  3  WHERE E.MGR=M.EMPNO
  4  GROUP BY M.ENAME
  5  HAVING COUNT(*)>=3;

ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
KING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    

SQL> -- WAQTD NAME OF THE DEPARTMENT IN WHICH THERE ARE ATLEAST 3 EMPLOYEES WHOS NAME HAS A CHAR 'A' IN IT
SQL> SELECT D.DNAME
  2  FROM EMP E,DEPT D
  3  WHERE E.DEPTNO=D.DEPTNO
  4  AND E.ENAME LIKE '%A%'
  5  GROUP BY D.DNAME
  6  HAVING COUNT(*)>=3;

DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
--------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> -- WAQTD NUMBER OF EMPLOYEES REPORTING TO KING
SQL> SELECT COUNT(*)
  2  FROM EMP
  3  WHERE MGR=(SELECT EMPNO FROM EMP WHERE ENAME='KING');

  COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
         3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> -- WAQTD NAME OF THE DEPARTMENT IN WHICH SMITH'S MANAGER IS WORKING
SQL> SELECT DNAME
  2  FROM DEPT
  3  WHERE DEPTNO=(SELECT DEPTNO
  4  FROM EMP
  5  WHERE EMPNO=(SELECT MGR
  6  FROM EMP
  7  WHERE ENAME='SMITH'));

DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
--------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                

SQL> -- WAQTD NUMBER OF EMPLOYEES ARE REPORTING TO BLAKES MANAGER
SQL> SELECT COUNT(*)
  2  FROM EMP
  3  WHERE MGR=(SELECT MGR
  4  FROM EMP
  5  WHERE ENAME='BLAKE');

  COUNT(*)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
         3                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> -- WAQTD NAME OF THE EMPLOYEE ALONG WITH HIS MANAGER ONLY IF MANAGER WORKING IN SALES DEPARTMENT
SQL> SELECT E.ENAME,M.ENAME
  2  FROM EMP E,EMP M,DEPT D
  3  WHERE E.MGR=M.EMPNO
  4  AND M.DEPTNO=D.DEPTNO
  5  AND D.DNAME='SALES';

ENAME      ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
---------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
JAMES      BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
TURNER     BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
MARTIN     BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
WARD       BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        
ALLEN      BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        

SQL> WAQTD DNAME AND AVERAGE SALARY FOR EACH DEPARTMENT EXCLUDING DEPT 20
SP2-0734: unknown command beginning "WAQTD DNAM..." - rest of line ignored.
SQL> -- WAQTD DNAME AND AVERAGE SALARY FOR EACH DEPARTMENT EXCLUDING DEPT 20
SQL> SELECT D.DNAME,AVG(E.SAL)
  2  FROM EMP E,DEPT D
  3  WHERE E.DEPTNO=D.DEPTNO
  4  AND D.DEPTNO<>20
  5  GROUP BY D.DNAME;

DNAME          AVG(E.SAL)                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
-------------- ----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
ACCOUNTING     2916.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               
SALES          1566.66667                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               

SQL> -- DISPLAY NAME OF THE EMPLOYEES REPORTING TO CLERK'S MANAGER'S MANAGER
SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE MGR=(SELECT MGR
  4  FROM EMP
  5  WHERE EMPNO=(SELECT MGR
  6  FROM EMP
  7  WHERE JOB='CLERK'));
WHERE EMPNO=(SELECT MGR
             *
ERROR at line 5:
ORA-01427: single-row subquery returns more than one row 


SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE MGR=(SELECT MGR
  4  FROM EMP
  5  WHERE EMPNO IN (SELECT MGR
  6  FROM EMP
  7  WHERE JOB = 'CLERK'));
WHERE MGR=(SELECT MGR
           *
ERROR at line 3:
ORA-01427: single-row subquery returns more than one row 


SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE MGR=(SELECT MGR FROM EMP WHERE EMPNO=(SELECT MGR FROM EMP WHERE JOB='CLERK'));
WHERE MGR=(SELECT MGR FROM EMP WHERE EMPNO=(SELECT MGR FROM EMP WHERE JOB='CLERK'))
                                            *
ERROR at line 3:
ORA-01427: single-row subquery returns more than one row 


SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE MGR IN (SELECT MGR
  4  FROM EMP
  5  WHERE EMPNO IN (SELECT MGR
  6  FROM EMP
  7  WHERE JOB = 'CLERK'));

ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
CLARK                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
BLAKE                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
JONES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
FORD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
SCOTT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   

SQL> -- WAQTD NAME OF EMP,HIS DNAME,HIS MANAGER NAME,HIS DNAME ONLY IF EMPLOYEES MANAGER'S MANAGER WORKS IN ACCOUNTING DEPARTMENT
SQL> SELECT E.ENAME,DE.DNAME,M.ENAME,DM.DNAME
  2  FROM EMP E,EMP M,DEPT DE,DEPT DM
  3  WHERE E.MGR=M.EMPNO
  4  AND E.DEPTNO=DE.DEPTNO
  5  AND M.DEPTNO=DM.DEPTNO
  6  AND M.MGR IN (SELECT EMPNO FROM EMP WHERE DEPTNO=(SELECT DEPTNO FROM DEPT WHERE DNAME='ACCOUNTING'));

ENAME      DNAME          ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -------------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
MILLER     ACCOUNTING     CLARK      ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
FORD       RESEARCH       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
SCOTT      RESEARCH       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
JAMES      SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
TURNER     SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
MARTIN     SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
WARD       SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ALLEN      SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

8 rows selected.

SQL> -- WAQTD DEPARTMENT NAME IN WHICH THERE ARE NO EMPLOYEES
SQL> SELECT DNAME
  2  FROM DEPT
  3  WHERE DEPTNO NOT IN (SELECT DISTINCT DEPTNO FROM EMP);

DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
--------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          
OPERATIONS                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

SQL> -- WAQDT NAME OF EMPLOYEE AND HIS MANAGER WITH HIS MANAGER ALONG WITH THEIR DEPARTMENT NAMES IF EMPLOYEE GETS LESS SALARY THAN MANAGER'S MANAGER
SQL> SELECT E.ENAME,DE.DNAME,M.ENAME,DM.DNAME
  2  FROM EMP E,EMP M,EMP MM,DEPT DE,DEPT DM
  3  WHERE E.MGR=M.EMPNO
  4  AND M.MGR=MM.EMPNO
  5  AND E.DEPTNO=DE.DEPTNO
  6  AND M.DEPTNO=DM.DEPTNO
  7  AND E.SAL<MM.SAL;

ENAME      DNAME          ENAME      DNAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
---------- -------------- ---------- --------------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     
MILLER     ACCOUNTING     CLARK      ACCOUNTING                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         
SMITH      RESEARCH       FORD       RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
ADAMS      RESEARCH       SCOTT      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
SCOTT      RESEARCH       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
FORD       RESEARCH       JONES      RESEARCH                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           
ALLEN      SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
WARD       SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
MARTIN     SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
TURNER     SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
JAMES      SALES          BLAKE      SALES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              

10 rows selected.

SQL> -- WAQTD NAMES OF EMPLOYEES INDIRECTLY REPORTING TO KING
SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE MGR IN (SELECT EMPNO FROM EMP WHERE MGR=(SELECT EMPNO FROM EMP WHERE ENAME='KING'));

ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
ALLEN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
WARD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MARTIN                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
SCOTT                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
TURNER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
JAMES                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
FORD                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    
MILLER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

8 rows selected.

SQL> -- WAQTD NAME OF THE EMPLOYEE GETTING 8TH MIN SALARY
SQL> SELECT ENAME
  2  FROM EMP
  3  WHERE SAL=(SELECT MIN(SAL) FROM (SELECT DISTINCT SAL FROM EMP ORDER BY SAL) WHERE ROWNUM=8);

no rows selected

SQL> WAQTD NAME OF THE EMPLOYEE WHO WAS HIRED AFTER 6 EMPLOYEES
SP2-0734: unknown command beginning "WAQTD NAME..." - rest of line ignored.
SQL> -- WAQTD NAME OF THE EMPLOYEE WHO WAS HIRED AFTER 6 EMPLOYEES
SQL> SELECT ENAME
  2  FROM (SELECT ENAME,ROWNUM RN FROM (SELECT ENAME FROM EMP ORDER BY HIREDATE))
  3  WHERE RN=7;

ENAME                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   
----------                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              
TURNER                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  

SQL> -- WAQTD DNAME,ENAME OF THE EMPLOYEES REPORTING TO MARTIN ONLY IF EMPLOYEE WORKS IN ACCOUNTING OR SALES DEPT
SQL> SELECT D.DNAME,E.ENAME
  2  FROM EMP E,DEPT D
  3  WHERE E.DEPTNO=D.DEPTNO
  4  AND E.MGR=(SELECT EMPNO FROM EMP WHERE ENAME='MARTIN')
  5  AND D.DNAME IN ('ACCOUNTING','SALES');

no rows selected

SQL> SPOOL OFF
